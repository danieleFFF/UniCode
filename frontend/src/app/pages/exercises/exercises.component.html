<div class="exercises-page-container container-fluid px-3 px-md-4 px-lg-5">
  <app-navbar></app-navbar>

  <header class="exercises-header">
    <h1>Welcome to Our Exercises</h1>
    <p>
      Put your skills to the test with hands-on coding challenges.<br>
      Filter by language and difficulty to find the perfect exercise.
    </p>
  </header>

  <div class="exercise-container">
    <div class="top-bar d-flex flex-wrap align-items-center gap-2 p-2 p-md-3">
      <div class="controls d-flex flex-wrap align-items-center gap-2 w-100">
        <label for="language" class="d-none d-md-inline">Language:</label>
        <div class="dropdown-wrapper position-relative">
          <button class="filter-btn language-button btn btn-dark" (click)="toggleLanguageMenu($event)">
            {{ selectedLanguage }} ▾
          </button>

          <div class="dropdown language-menu" *ngIf="showLanguageMenu">
            <button *ngFor="let lang of languages" (click)="selectLanguage(lang)">
              {{ lang }}
            </button>
          </div>
        </div>

        <div class="filter-group d-flex align-items-center gap-2 flex-wrap position-relative">
          <button (click)="toggleFilterMenu($event)" class="filter-btn filter-button btn btn-dark">
            {{ selectedFilterName }} ▾
          </button>
          <div class="dropdown filter-menu" *ngIf="showFilterMenu">
            <button (click)="applySort('title')">Alphabetic</button>
            <button (click)="applySort('difficulty')">Difficulty</button>
            <button (click)="applySort('points')">Points</button>
          </div>

          <button (click)="toggleOrder()" class="order-btn btn btn-dark">
            {{ sortOrder === 'asc' ? 'Asc ↑' : 'Desc ↓' }}
          </button>
        </div>
      </div>
    </div>

    <div *ngIf="exercises.length > 0; else noExercises" class="exercise-list">
      <div class="exercise-card row g-0 align-items-center p-3 mb-3" *ngFor="let ex of exercises">
        <div class="exercise-content col-12 col-md-9 col-lg-10">
          <div class="exercise-header d-flex flex-wrap align-items-baseline gap-2 mb-1">
            <span class="difficulty" [style.color]="getXpColor(ex.difficulty)">
              ({{ ex.difficulty }})
            </span>
            <span class="title">{{ ex.title }}</span>
          </div>
          <div class="points" *ngIf="ex.points > 0">(Max points: {{ ex.points }})</div>
          <div class="description">
            <p class="mb-0">{{ ex.description }}</p>
          </div>
        </div>

        <div class="col-12 col-md-3 col-lg-2 mt-3 mt-md-0 d-flex justify-content-md-end">
          <button class="solve-btn btn w-100 w-md-auto" [routerLink]="['/solve', ex.id]">
            SOLVE
          </button>
        </div>
      </div>
    </div>

    <ng-template #noExercises>
      <div class="no-results">No exercises found for {{ selectedLanguage }}.</div>
    </ng-template>
  </div>

</div>
