<div class="auth-page-container">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 col-md-8 col-lg-6 col-xl-5 d-flex justify-content-center">
        <form class="auth-form-container" (ngSubmit)="onSubmit()">
          <div class="back-link-container">
            <a (click)="goBack()" class="back-link">âž”</a>
          </div>

          <div class="text-center mb-2 mb-md-3">
            <img src="../../../assets/images/forgottenpasswordtransp.png" alt="Forgotten Password Logo" class="auth-logo">
          </div>

          <h2 class="auth-title">Reset Password</h2>
          <p class="auth-subtitle">Enter your new password and the code sent to your email</p>

          <div class="timer-container mb-3">
            @if (countdown > 0) {
              <label class="timer-label">Code expires in {{ countdown }}s</label>
            }
            @if (showResendButton) {
              <button (click)="resendCode()" type="button" class="resend-btn">Resend Code</button>
            }
          </div>

          <div class="row">
            <div class="col-12">
              <div class="auth-input-group mb-3">
                <img src="../../../assets/images/lockicon.png" class="auth-input-icon" alt="Password icon">
                <input
                  class="auth-input-field"
                  [type]="showPassword ? 'text' : 'password'"
                  id="password"
                  name="password"
                  placeholder="New Password"
                  [(ngModel)]="password"
                  required
                  (copy)="disableCopy($event)"
                  (cut)="disableCopy($event)"
                  (blur)="validatePasswordField()"
                  autocomplete="new-password">
                <img
                  [src]="showPassword ? 'assets/images/openedeyeicon.png' : 'assets/images/closedeyeicon.png'"
                  class="auth-password-eye"
                  alt="Toggle password visibility"
                  (click)="togglePassword()">
              </div>

              @if (passwordError) {
                <div class="mb-3">
                  <label class="error-label">{{ passwordError }}</label>
                </div>
              }
            </div>

            <div class="col-12">
              <div class="auth-input-group mb-3">
                <img src="../../../assets/images/lockicon.png" class="auth-input-icon" alt="Password icon">
                <input
                  class="auth-input-field"
                  [type]="showPasswordConfirmation ? 'text' : 'password'"
                  id="passwordConfirmation"
                  name="passwordConfirmation"
                  placeholder="Confirm New Password"
                  [(ngModel)]="passwordConfirmation"
                  required
                  (copy)="disableCopy($event)"
                  (cut)="disableCopy($event)"
                  (blur)="validatePasswordConfirmationField()"
                  autocomplete="new-password">
                <img
                  [src]="showPasswordConfirmation ? 'assets/images/openedeyeicon.png' : 'assets/images/closedeyeicon.png'"
                  class="auth-password-eye"
                  alt="Toggle password visibility"
                  (click)="togglePasswordConfirmation()">
              </div>

              @if (passwordConfirmationError) {
                <div class="mb-3">
                  <label class="error-label">{{ passwordConfirmationError }}</label>
                </div>
              }
            </div>

            <div class="col-12">
              <div class="auth-input-group mb-3">
                <img src="../../../assets/images/lockicon.png" class="auth-input-icon" alt="Code icon">
                <input
                  class="auth-input-field"
                  [type]="showCode ? 'text' : 'password'"
                  id="secretCode"
                  name="secretCode"
                  placeholder="Secret Code"
                  [(ngModel)]="secretCode"
                  required
                  (copy)="disableCopy($event)"
                  (cut)="disableCopy($event)"
                  (blur)="validateSecretCodeField()"
                  autocomplete="off">
                <img
                  [src]="showCode ? 'assets/images/openedeyeicon.png' : 'assets/images/closedeyeicon.png'"
                  class="auth-password-eye"
                  alt="Toggle code visibility"
                  (click)="toggleSecretCode()">
              </div>

              @if (secretCodeError) {
                <div class="mb-3">
                  <label class="error-label">{{ secretCodeError }}</label>
                </div>
              }
            </div>

            <div class="col-12">
              <button type="submit" class="auth-submit-btn w-100" [disabled]="isSubmitting">
                {{ isSubmitting ? 'Resetting...' : 'Reset Password' }}
              </button>
            </div>

            @if (errorMessage) {
              <div class="col-12 mt-3">
                <div class="error-message-container">
                  <label class="error-message">{{ errorMessage }}</label>
                </div>
              </div>
            }

            @if (successMessage) {
              <div class="col-12 mt-3">
                <div class="success-message-container">
                  <label class="success-message">{{ successMessage }}</label>
                </div>
              </div>
            }
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
