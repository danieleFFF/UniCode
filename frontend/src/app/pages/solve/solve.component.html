<div class="solve-page-container">
  <app-navbar></app-navbar>

  <div class="solve-container">
    <div class="exercise-side">
      <div class="exercise-header">
        <div class="meta">
          <span class="difficulty" [ngClass]="exercise?.difficulty?.toLowerCase()">
            {{ exercise?.difficulty }}
          </span>
          |
          <span class="language">{{ selectedLanguage }}</span>
        </div>
        <div class="meta">
          <span>{{ currentPoints }} pts</span> |
          <span class="timer">{{ formattedTime }}</span>
        </div>
      </div>

      <h2 class="title">{{ exercise?.title }}</h2>
      <p class="desc">{{ exercise?.description }}</p>

      <div *ngIf="showResults" class="results">
        <div class="results-header">
          <h4>Test Results</h4>
          <span class="badge" [class.ok]="allPassed" [class.ko]="!allPassed">
            {{ allPassed ? 'All test cases succeeded' : 'Some test cases failed' }}
          </span>
        </div>
        <div *ngFor="let test of testResults" [ngClass]="{ ok: test.passed, fail: !test.passed }">
          {{ test.passed ? '✔' : '✘' }} {{ test.name }} — {{ test.message }}
        </div>
        <div *ngIf="consoleOutput" class="console-box">
          <pre>{{ consoleOutput }}</pre>
        </div>

        <div *ngIf="programOutput" class="output-box">
          <h4>Detailed Output</h4>
          <pre>{{ programOutput }}</pre>
        </div>
      </div>
    </div>

    <div class="editor-side">
      <div class="editor-topbar">
        <button class="btn" (click)="runTests()" [disabled]="alreadyCompleted || isRunning">{{ isRunning ? 'Running...' : 'Test' }}</button>
        <span class="console-label">Console</span>
      </div>

      <textarea name="code" [(ngModel)]="userCode" placeholder="// Write your code here..."></textarea>
    </div>
  </div>
</div>
